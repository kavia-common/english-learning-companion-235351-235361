{"is_source_file": true, "format": "JavaScript", "description": "This file implements the QuizzesService class, which manages creation, retrieval, question generation, and submission of quizzes associated with lessons in an English learning platform. It interacts with the database to manage quizzes, questions, and quiz attempts.", "external_files": ["../db", "../middleware/errors"], "external_methods": ["db.query", "ApiError"], "published": ["QuizzesService"], "classes": [{"name": "QuizzesService", "description": "A service class responsible for generating, retrieving, and submitting quizzes associated with lessons, including question generation from lesson content and answer evaluation."}], "methods": [{"name": "_getOrCreateQuizForLesson(lessonId)", "description": "Retrieves an existing quiz for a lesson or creates a new one if none exists.", "scope": "QuizzesService", "scopeKind": "class"}, {"name": "_ensureQuestions(quizId, lessonId)", "description": "Ensures that a quiz has questions, generating them from vocabulary and grammar points in the lesson if necessary.", "scope": "QuizzesService", "scopeKind": "class"}, {"name": "generateQuiz(lessonId)", "description": "Public method to generate and retrieve a complete quiz for a given lesson ID, reusing existing data if present.", "scope": "QuizzesService", "scopeKind": "class"}, {"name": "getQuizById(quizId)", "description": "Public method to retrieve a quiz and its questions by quiz ID.", "scope": "QuizzesService", "scopeKind": "class"}, {"name": "submitQuiz(quizId, userId, answers)", "description": "Submits user answers for a quiz, evaluates the score, and records the attempt.", "scope": "QuizzesService", "scopeKind": "class"}, {"name": "normalizeAnswer(a)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["db.query", "new ApiError"], "search-terms": ["quizzes.js", "QuizzesService class", "generateQuiz method", "submitQuiz method", "lesson content_json"], "state": 2, "file_id": 18, "knowledge_revision": 102, "git_revision": "", "revision_history": [{"57": ""}, {"88": ""}, {"102": ""}], "ctags": [{"_type": "tag", "name": "QuizzesService", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^class QuizzesService {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "_ensureQuestions", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^  async _ensureQuestions(quizId, lessonId) {$/", "language": "JavaScript", "kind": "method", "signature": "(quizId, lessonId)", "scope": "QuizzesService", "scopeKind": "class"}, {"_type": "tag", "name": "_getOrCreateQuizForLesson", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^  async _getOrCreateQuizForLesson(lessonId) {$/", "language": "JavaScript", "kind": "method", "signature": "(lessonId)", "scope": "QuizzesService", "scopeKind": "class"}, {"_type": "tag", "name": "db", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^const db = require('..\\/db');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^module.exports = new QuizzesService();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "generateQuiz", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^  async generateQuiz(lessonId) {$/", "language": "JavaScript", "kind": "method", "signature": "(lessonId)", "scope": "QuizzesService", "scopeKind": "class"}, {"_type": "tag", "name": "getQuizById", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^  async getQuizById(quizId) {$/", "language": "JavaScript", "kind": "method", "signature": "(quizId)", "scope": "QuizzesService", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeAnswer", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^function normalizeAnswer(a) {$/", "language": "JavaScript", "kind": "function", "signature": "(a)"}, {"_type": "tag", "name": "submitQuiz", "path": "/home/kavia/workspace/code-generation/english-learning-companion-235351-235361/backend/src/services/quizzes.js", "pattern": "/^  async submitQuiz(quizId, userId, answers) {$/", "language": "JavaScript", "kind": "method", "signature": "(quizId, userId, answers)", "scope": "QuizzesService", "scopeKind": "class"}], "hash": "fd1ed02b6138f6c5779e00e571b6c927", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/services/quizzes.js", "fields": [{"name": "module.exports = new QuizzesService();", "scope": "module", "scopeKind": "class", "description": "unavailable"}]}